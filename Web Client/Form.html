<!DOCTYPE html>
<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>

		<title>Web Form</title>
		<h1>Ticket Submission Form</h1>
		<style>
			h1
			{
				font-family: "helvetica, sans-serif";
				font-size: 300%;
				text-align: center;
			}

			body
			{
				font-family: verdana;
				background-color: lightsteelblue;
			}
							
			#container
			{
				text-align: center;    
			}

			#container .form-container
			{
				display: inline-block;
			}

			#container form
			{
				background: #eee;
				display: flex;
				flex-direction: row;
				flex-wrap: nowrap;
				padding: 20px;
			}

			#container form .column
			{
				display: flex;
				flex-direction: column;
				flex-wrap: nowrap;
			}

			#container form .column label
			{
				padding: 2px;
				text-align: right;
				margin-bottom: 19px;
				margin-right: 25px;
			}

			#container form .column input, 
			#container form .column textarea
			{
				align-self: flex-start;
				width: 200px;
				margin-bottom: 23px;
			}
			
			
			label
			{
				display: block;
			}		
			
			.submit_button
			{
				display: block;
				height: 60px;
				width: 150px;
				/* border: 4px solid LightGreen; */
				border-radius: 20px;
				font-family: verdana;
				font-size: 170%;
				background-color: LightGreen;
				color: MidnightBlue;

				margin: 0;
				position: absolute;
				left: 80%;
				transform: translate(-40%, -400%);
			}

			.submit_button:hover
			{
				background-color: DarkCyan;
			}
			
			.asterisk
			{
				color: red;
			}
			
		</style>
	</head>
	
	<body>
		<div id="container">
			<div class="form-container">
				<form>
					<div class="column">
						<label for="eid">Employee ID</label>
						<label for="f_name">First Name</label>
						<label for="l_name">Last Name</label>
						<label for="short_description" style="margin-top:14px; margin-bottom:80px;">Short Description</label>
						<label for="long_description">Long Description</label>
					</div>
					<div class="column">
						<input type="text" name="eid" id="eid"/>
						<input type="text" name="f_name" id="f_name"/>
						<input type="text" name="l_name" id="l_name"/>
						<textarea name="short_description" style="width:300px; height:40px; resize:none;"></textarea>
						<textarea name="long_description" style="width:300px; height:120px; resize:none;"></textarea>
					</div>
				</form>
			</div>
		</div>

		<!-- Dropdown List -->
		<label for="categories" style="text-align:center; margin-top:30px;"> Ticket Category:</label>
		
		<div style="text-align:center;">
		<select id="categories" name="categories">
			<option value="new_equipment">New Equipment</option>
			<option value="damaged_equipment">Damaged Equipment</option>
		</select>
		</div>

		<input type="button" name="submit_button" id="submit_button" value="Submit" class="submit_button"/>
		<div id="response" style="margin-top:-400px; margin-left:200px;"></div>
	</body>
</html>

<!-- Javascript -->
<script>
	$(document).ready(function()
	{
		$('#submit_button').click(function()
		{
			//Confirm that all fields are filled
			var e_id = $('#eid').val();
			var f_name = $('#f_name').val();
			var l_name = $('#l_name').val();
			//TODO: add the rest of the fields
			if (e_id == "" || f_name == "" || l_name == "")
			{
				$('#response').html('<span>Missing at least one field!</span>');
			}
			//If all fields are filled, proceed with insertion request
			else
			{
				send_insertion_request();
			}
		});
	});

	function send_insertion_request()
	{
		$.ajax({
			url:		"database_access.php",
			type:		"POST",
			data:		$('form').serialize(),
			beforeSend: function()
			{
				$('#response').html('<span>Submitting ticket...</span>');
			},
			success:	function (data)
			{
				console.log("this is data");
				//console.log(data);
				$('form').trigger("reset");
				$('#response').fadeIn().html(data);
			},
			error: function ()
			{
				console.log("Error occurred! Insertion request failed...");
			}
		});
	}
</script>
